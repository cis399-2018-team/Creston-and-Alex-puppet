

###Stop sshd.
ubuntu@ip-10-0-6-209:~$ sudo service sshd stop
ubuntu@ip-10-0-6-209:~$ sudo puppet agent -t
Info: Retrieving pluginfacts
Info: Retrieving plugin
Info: Caching catalog for ip-10-0-6-209.us-west-2.compute.internal
Info: Applying configuration version '1531720668'
Notice: /Stage[main]/Sshd/Service[sshd]/ensure: ensure changed 'stopped' to 'running'
Info: /Stage[main]/Sshd/Service[sshd]: Unscheduling refresh on Service[sshd]
Notice: Finished catalog run in 0.12 seconds

##remove sshd.
ubuntu@ip-10-0-6-209:~$ sudo apt-get remove openssh-server
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages will be REMOVED:
  openssh-server
0 upgraded, 0 newly installed, 1 to remove and 16 not upgraded.
After this operation, 904 kB disk space will be freed.
Do you want to continue? [Y/n] y
(Reading database ... 54776 files and directories currently installed.)
Removing openssh-server (1:7.2p2-4ubuntu2.4) ...
Processing triggers for man-db (2.7.5-1) ...
ubuntu@ip-10-0-6-209:~$ sudo puppet agent -t
Info: Retrieving pluginfacts
Info: Retrieving plugin
Info: Caching catalog for ip-10-0-6-209.us-west-2.compute.internal
Info: Applying configuration version '1531720668'
Notice: /Stage[main]/Sshd/Package[openssh-server]/ensure: created
Notice: Finished catalog run in 2.85 seconds

## modify/delete sshd_config
ubuntu@ip-10-0-6-209:/etc/ssh$ sudo mv sshd_config backupsshdconfig
ubuntu@ip-10-0-6-209:/etc/ssh$ ls
backupsshdconfig  ssh_host_dsa_key      ssh_host_ecdsa_key.pub    ssh_host_rsa_key
moduli            ssh_host_dsa_key.pub  ssh_host_ed25519_key      ssh_host_rsa_key.pub
ssh_config        ssh_host_ecdsa_key    ssh_host_ed25519_key.pub  ssh_import_id
ubuntu@ip-10-0-6-209:/etc/ssh$ sudo puppet agent -t
Info: Retrieving pluginfacts
Info: Retrieving plugin
Info: Caching catalog for ip-10-0-6-209.us-west-2.compute.internal
Info: Applying configuration version '1531720668'
Notice: /Stage[main]/Sshd/File[sshd_config]/ensure: defined content as '{md5}5e86f038a131a81281a6379366892c40'
Info: /Stage[main]/Sshd/File[sshd_config]: Scheduling refresh of Service[sshd]
Notice: /Stage[main]/Sshd/Service[sshd]: Triggered 'refresh' from 1 events
Notice: Finished catalog run in 0.16 seconds

##Modify or delete .ssh/authorized_keys in an instance's user account.
ubuntu@ip-10-0-6-209:~/.ssh$ mv authorized_keys authorized_keysbackup
ubuntu@ip-10-0-6-209:~/.ssh$ ls
authorized_keysbackup
ubuntu@ip-10-0-6-209:~/.ssh$ sudo puppet agent -t
Info: Retrieving pluginfacts
Info: Retrieving plugin
Info: Caching catalog for ip-10-0-6-209.us-west-2.compute.internal
Info: Applying configuration version '1531720668'
Notice: /Stage[main]/Sshd/Ssh_authorized_key[crestonw_id.pem]/ensure: created
Notice: /Stage[main]/Sshd/Ssh_authorized_key[aarcher]/ensure: created
Notice: Finished catalog run in 0.09 seconds
ubuntu@ip-10-0-6-209:~/.ssh$ cat authorized_keys
# HEADER: This file was autogenerated at 2018-07-16 06:08:40 +0000
# HEADER: by puppet.  While it can still be managed manually, it
# HEADER: is definitely not recommended.
    ...
    ...
	<our keys>
	...
	...